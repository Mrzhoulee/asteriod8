<!DOCTYPE html>
<html lang="en">

<head>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css" integrity="sha512-DxV+EoADOkOygM4IR9yXP8Sb2qwgidEmeqAEmDKIOfPRQZOWbXCzLC6vjbZyy0vPisbH2SyW27+ddLVCN+OMzQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@100;400;500;600;700;800;900&display=swap"
    rel="stylesheet">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Asteroid Teams Media Studio</title>
  <style>
    body {
      background-color: antiquewhite;
      font-family: "Montserrat", sans-serif;
      margin: 0;
      height: 100vh;
    }

 input {
  display: inline-block;
  vertical-align: 50px /* Optional: aligns elements vertically */
}

label {
  margin-right: 5px; /* Optional: adds spacing between label and input */
}


    .upload-btn {
      width: 90px;
      height: 40px;
      background-color: coral;
      color: black;
      border-radius: 10%;
      transition: ease-in 0.5s;
    }

    .upload-btn:hover {
      width: 140px;
      height: 90px;
      background-color: lightsalmon;
      font-size: large;
    }

    .bar {
      height: 50px;
      width: 500px;
      background-color: grey;
      position: relative;
    }

    .progress {
      background: linear-gradient(12deg, red, blue);
      position: relative;
      width: 0;
    }


.inline-container h3,
  .inline-container input {
    display: inline-block;
    vertical-align: middle; /* Align elements vertically */
    margin-right: 10px; /* Add some space between them */
  }


    .alert {
      opacity: 0;
      background-color: coral;
    }

    .alertBox {
      background-color: lightcoral;
      width: 500px;
      height: 100px;
      visibility: hidden;
      border-radius: 10%;
      text-align: center;
    }


    .google-sign-in{
      display: block;
    }
    .ht5 {
      background-color: lightcoral;
      width: 800px;
      height: 100px;
      display:none;
      border-radius: 10%;
      text-align: center;
    }
    canvas {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      pointer-events: none;
      /* Allow clicks to pass through the canvas */
    }


    @media only screen and (max-width:1200px){
      .hellothere{
      position: absolute;
      top: 400px;
      left: 180px;
      }
    }
  </style>
</head>

<body>
<div class="hellothere">
  <div style="position: absolute; top: 0px; left: 90px;">
    <a href="index.html"><button style="width: 200px !important; height: 45px !important; font-size: large; border-radius: 10%; background-color: black; color: coral;">Back</button></a>
  </div>
</div>
    <div style="position: absolute; top: 0; right: 90px; ">


<div style="color: black">
    <button style="background-color: white;" id="google-sign-in"><span id="gcm" style="font-size: medium; color: black;"><font color="black">Continue With
        <i class="fa-brands fa-google"></i> </font></span></button>

</div>

  </div>
<center>
  <h1>Asteroid Teams Studio</h1>
  <h2>Upload Media</h2>

  <form id="uploadForm" class="formUpload">
    <div id="referralBadge" style="display: none; background: #00ff88; color: black; padding: 10px; border-radius: 5px; margin-bottom: 15px; font-weight: bold; text-align: center;">
  âœ¨ Referral Active: You are eligible for a Feature!
</div>
    <div id="tutorialBox" style="display:none; background: #fff; border: 3px solid #00ff88; padding: 20px; border-radius: 15px; max-width: 600px; margin-bottom: 20px; text-align: left;">
  <h2 style="color: #008044; margin-top: 0;">ðŸŒŸ How to get Featured</h2>
  <ol>
    <li><strong>Sign In:</strong> Use the Google button above (Required for tracking).</li>
    <li><strong>Fill Details:</strong> Enter your Song Title, Artist Name, and Album.</li>
    <li><strong>Upload:</strong> Select your MP3 file and click Upload.</li>
    <li><strong>Confirmation:</strong> Once finished, your track is automatically flagged for the February Feature list!</li>
  </ol>
</div>

<div id="referralTracker" style="display:none; background: white; border: 2px solid coral; padding: 15px; border-radius: 10px; max-width: 500px; margin-bottom: 20px;">
  <h3 style="margin-top:0;">ðŸš€ 3-Month Feature Challenge</h3>
  <p>Invite 3 friends to sign in. Once they do, you unlock a 3-month feature on all social medias!</p>
  <div style="background: #eee; border-radius: 10px; height: 20px; width: 100%; margin: 10px 0;">
    <div id="progressBarStatus" style="background: coral; height: 100%; width: 0%; border-radius: 10px; transition: 0.5s;"></div>
  </div>
  <p id="countText">Invites: 0 / 3</p>
  <p id="unlockMsg" style="color: green; font-weight: bold; display: none;">âœ… You've earned a 3-Month Feature!</p>
</div>
    <span class="fileText"></span>
    <input type="text" id="title" placeholder="Enter Title" required>
    <input type="file" class="inputFile" id="fileInp" accept="audio/mpeg" required />
    <input type="text" id="album" placeholder="Enter your custom Album" required>
    <input type="text" id="artist" placeholder="Enter the Song Artist" class="text" required>
    <center>
    <button id="btn" class="upload-btn" type="button"><b>Upload</b></button>
    <button id="Boostpost" class="upload-btn" type="button"><b>BOOST POST</b></button>
    </center>
<div class="inline-container">
  <input type="checkbox" id="agreement">
  <label for="agreement">
    I confirm that I am the rightful owner of <span id="titlelol"></span>, 
    or have full legal rights to upload it. 
    If I do not, I accept all liability and Asteroid may remove this content 
    and suspend my account.
  </label>
</div>

  </center>
  </form>

<center>
      <div class="alertBox" id="alt5">
    <h1><b>The agreement checkbox is required.</b></h1>
  </div>
  <div class="alertBox" id="alertBox">
    <h1><b>Your Song is being uploaded, Please wait...</b></h1>
   
  </div>
  <div class="alertBox" id="alt1">
    <h1><b>Please fill out the  song information</b></h1>
  </div>

  <div class="alertBox" id="ooaa">
    <h1><b>Your Song is Successfully uploaded!</b></h1>
  </div>


    <div class="ht5" id="alt2">
    <h1><b>If your song is a single then enter "Singles" in the album form instead of leaving it blank. </b></h1>
  </div>
<div style="text-align: center !important;">
    <h1>Uploading Guide</h1>
  <font face="Montserrat">
  1. Enter your Song Title
  <br>

  2. Enter your Artist names
  <br>

  3. Enter your Album, if it's a single then just enter Single
  <br>

  4. Make sure you're signed in and please also tick the agreement box
  <br>
  
  5. Click Upload then you're done!
</font>
</div>
  </div>
  <div class="bar">
    <div class="progress"></div>
  </div>


</center>
  <canvas id="can"></canvas>


  <script>
    const button = document.getElementById('btn')
    button.addEventListener('click', () => {
      let progress = document.getElementById("progress");
      const interval = setInterval(() => {
        if (progress = 100) {
          clearInterval(interval);
        } else {
          progress += 5;
          progressBar.style.width = progress + '%';
        }
      }, 1000);

    });
  </script>




  <script src="https://cdn.jsdelivr.net/npm/js-confetti@latest/dist/js-confetti.browser.js"></script>
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
  import { getDatabase, ref as ref2, set, update, get, onValue, increment } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-database.js";
  import { getAuth, signInWithPopup, GoogleAuthProvider } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";
  import { getStorage, getDownloadURL, uploadBytes, ref } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-storage.js";

  const firebaseConfig = {
    apiKey: "AIzaSyAAvcxcXXNezL5Jip4A9WMkv_r5fpmsDoY",
    authDomain: "asteroid-cdc13.firebaseapp.com",
    databaseURL: "https://asteroid-cdc13-default-rtdb.firebaseio.com",
    projectId: "asteroid-cdc13",
    storageBucket: "asteroid-cdc13.appspot.com",
    messagingSenderId: "793353824502",
    appId: "1:793353824502:web:3ac24821911d14773ba4d7"
  };

  const app = initializeApp(firebaseConfig);
  const database = getDatabase(app);
  const auth = getAuth(app);
  const storage = getStorage(app);
  const provider = new GoogleAuthProvider();

  // --- 1. REFERRAL TRACKING ---
  function initReferral() {
    const urlParams = new URLSearchParams(window.location.search);
    const inviter = urlParams.get('by'); // The person who shared the link

    if (inviter) {
      localStorage.setItem('pendingReferrer', inviter);
    }
  }

  // --- 2. GOOGLE SIGN IN & REWARD LOGIC ---
  document.getElementById("google-sign-in").addEventListener("click", () => {
    signInWithPopup(auth, provider).then(async (result) => {
      const user = result.user;
      const safeEmail = user.email.replace(/\./g, ',');
      const inviterName = localStorage.getItem('pendingReferrer');

      localStorage.setItem("email", user.email);
      localStorage.setItem("fullName", user.displayName);

      // Check if this is a new referral
      const userRef = ref2(database, 'users/' + safeEmail);
      const snapshot = await get(userRef);

      if (!snapshot.exists() && inviterName) {
        // This is a new person clicking an invite link! 
        // Give credit to the person who invited them
        const inviterRef = ref2(database, 'referralCounts/' + inviterName);
        await update(inviterRef, {
          count: increment(1)
        });
        localStorage.removeItem('pendingReferrer'); // Reward given
      }

      // Save user profile
      update(userRef, { email: user.email, name: user.displayName });
      
      showShareTools(user.displayName);
      trackMyProgress(user.displayName);
    });
  });

  // --- 3. PROGRESS TRACKER ---
  function trackMyProgress(myName) {
    const cleanName = myName.replace(/\s+/g, '_');
    const myRef = ref2(database, 'referralCounts/' + cleanName);
    
    onValue(myRef, (snapshot) => {
      const data = snapshot.val();
      const count = data ? data.count : 0;
      
      document.getElementById('referralTracker').style.display = 'block';
      document.getElementById('countText').innerText = `Invites: ${count} / 3`;
      
      const progressPercent = Math.min((count / 3) * 100, 100);
      document.getElementById('progressBarStatus').style.width = progressPercent + "%";

      if (count >= 3) {
        document.getElementById('unlockMsg').style.display = 'block';
        // Flag user in database for 3-month feature
        const safeEmail = localStorage.getItem("email").replace(/\./g, ',');
        update(ref2(database, 'users/' + safeEmail), { eligibility: "3_MONTH_FEATURE" });
      }
    });
  }

  // --- 4. SHARE LINK GENERATOR ---
  function showShareTools(name) {
    const cleanName = name.replace(/\s+/g, '_');
    document.getElementById('shareSection').style.display = 'block';
    document.getElementById('shareLinkInput').value = `https://asteroid8.net/studio.html?ref=ARTISTSOFFEB26&by=${cleanName}`;
  }

  // Copy function...
  document.getElementById("copyBtn").addEventListener("click", () => {
    const input = document.getElementById("shareLinkInput");
    input.select();
    navigator.clipboard.writeText(input.value);
    alert("Link Copied! Send this to 3 artists to get featured for 3 months!");
  });

  initReferral();
</script>
</body>


</html>









